SBATCH job
Started 11/11/2024 20:28:45
Working directory /eejit/home/hausw001/HybGGM/hybGGM_test
expandable_segments:True
UNet6 with 1 50 0.0001 32 180 start at Mon Nov 11 20:28:46 CET 2024
CUDA is available! Using GPU.
device: cuda
Hyperparameter tuning not done yet - start process
data testing folder already prepared - reloading data
Hyperparameter tuning definition and start
training model: UNet6, learning rate: 0.0001, epochs: 50, batch size: 32
Before cleanup - Allocated memory: 1898.89 MB, Reserved memory: 1904.00 MB
Epoch 1/50
0
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1986 MiB |   1986 MiB |   1986 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |   1986 MiB |   1986 MiB |   1986 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |   1986 MiB |   1986 MiB |   1986 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |      4 MiB |      4 MiB |      4 MiB |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2006 MiB |   2006 MiB |   2006 MiB |      0 B   |
|       from large pool |   2000 MiB |   2000 MiB |   2000 MiB |      0 B   |
|       from small pool |      6 MiB |      6 MiB |      6 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |     199    |     199    |     199    |       0    |
|       from large pool |      25    |      25    |      25    |       0    |
|       from small pool |     174    |     174    |     174    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     199    |     199    |     199    |       0    |
|       from large pool |      25    |      25    |      25    |       0    |
|       from small pool |     174    |     174    |     174    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

train loss item: 0.3934691548347473
1
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 4            |        cudaMalloc retries: 4         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3885 MiB |   8758 MiB |  54835 MiB |  50949 MiB |
|       from large pool |   3878 MiB |   8753 MiB |  54819 MiB |  50941 MiB |
|       from small pool |      7 MiB |      7 MiB |     15 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   3885 MiB |   8758 MiB |  54835 MiB |  50949 MiB |
|       from large pool |   3878 MiB |   8753 MiB |  54819 MiB |  50941 MiB |
|       from small pool |      7 MiB |      7 MiB |     15 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3885 MiB |   8758 MiB |  54835 MiB |  50949 MiB |
|       from large pool |   3878 MiB |   8753 MiB |  54819 MiB |  50941 MiB |
|       from small pool |      7 MiB |      7 MiB |     15 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9348 MiB |   9348 MiB |  12168 MiB |   2820 MiB |
|       from large pool |   9340 MiB |   9340 MiB |  12160 MiB |   2820 MiB |
|       from small pool |      8 MiB |      8 MiB |      8 MiB |      0 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |     318    |     338    |     730    |     412    |
|       from large pool |      48    |     100    |     349    |     301    |
|       from small pool |     270    |     272    |     381    |     111    |
|---------------------------------------------------------------------------|
| Active allocs         |     318    |     338    |     730    |     412    |
|       from large pool |      48    |     100    |     349    |     301    |
|       from small pool |     270    |     272    |     381    |     111    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

train loss item: 0.35504150390625
2
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 4            |        cudaMalloc retries: 4         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3885 MiB |   8758 MiB | 107705 MiB | 103819 MiB |
|       from large pool |   3878 MiB |   8753 MiB | 107678 MiB | 103799 MiB |
|       from small pool |      7 MiB |      7 MiB |     26 MiB |     19 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   3885 MiB |   8758 MiB | 107705 MiB | 103819 MiB |
|       from large pool |   3878 MiB |   8753 MiB | 107678 MiB | 103799 MiB |
|       from small pool |      7 MiB |      7 MiB |     26 MiB |     19 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3885 MiB |   8758 MiB | 107705 MiB | 103819 MiB |
|       from large pool |   3878 MiB |   8753 MiB | 107678 MiB | 103799 MiB |
|       from small pool |      7 MiB |      7 MiB |     26 MiB |     19 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9368 MiB |   9368 MiB |  12188 MiB |   2820 MiB |
|       from large pool |   9360 MiB |   9360 MiB |  12180 MiB |   2820 MiB |
|       from small pool |      8 MiB |      8 MiB |      8 MiB |      0 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |     318    |     338    |    1261    |     943    |
|       from large pool |      48    |     100    |     673    |     625    |
|       from small pool |     270    |     272    |     588    |     318    |
|---------------------------------------------------------------------------|
| Active allocs         |     318    |     338    |    1261    |     943    |
|       from large pool |      48    |     100    |     673    |     625    |
|       from small pool |     270    |     272    |     588    |     318    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

train loss item: 0.26434504985809326
3
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 4            |        cudaMalloc retries: 4         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3885 MiB |   8758 MiB | 160552 MiB | 156666 MiB |
|       from large pool |   3878 MiB |   8753 MiB | 160513 MiB | 156635 MiB |
|       from small pool |      7 MiB |      7 MiB |     38 MiB |     31 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   3885 MiB |   8758 MiB | 160552 MiB | 156666 MiB |
|       from large pool |   3878 MiB |   8753 MiB | 160513 MiB | 156635 MiB |
|       from small pool |      7 MiB |      7 MiB |     38 MiB |     31 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3885 MiB |   8758 MiB | 160552 MiB | 156666 MiB |
|       from large pool |   3878 MiB |   8753 MiB | 160513 MiB | 156635 MiB |
|       from small pool |      7 MiB |      7 MiB |     38 MiB |     31 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9368 MiB |   9368 MiB |  12188 MiB |   2820 MiB |
|       from large pool |   9360 MiB |   9360 MiB |  12180 MiB |   2820 MiB |
|       from small pool |      8 MiB |      8 MiB |      8 MiB |      0 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |     318    |     338    |    1792    |    1474    |
|       from large pool |      48    |     100    |     997    |     949    |
|       from small pool |     270    |     272    |     795    |     525    |
|---------------------------------------------------------------------------|
| Active allocs         |     318    |     338    |    1792    |    1474    |
|       from large pool |      48    |     100    |     997    |     949    |
|       from small pool |     270    |     272    |     795    |     525    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

train loss item: 0.25740987062454224
Accumulated train loss (approx): 1.029639482498169
4
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 4            |        cudaMalloc retries: 4         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   5784 MiB |   9493 MiB | 219064 MiB | 213279 MiB |
|       from large pool |   5774 MiB |   9478 MiB | 219005 MiB | 213231 MiB |
|       from small pool |     10 MiB |     14 MiB |     58 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   5784 MiB |   9493 MiB | 219064 MiB | 213279 MiB |
|       from large pool |   5774 MiB |   9478 MiB | 219005 MiB | 213231 MiB |
|       from small pool |     10 MiB |     14 MiB |     58 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   5784 MiB |   9493 MiB | 219064 MiB | 213279 MiB |
|       from large pool |   5774 MiB |   9478 MiB | 219005 MiB | 213231 MiB |
|       from small pool |      9 MiB |     14 MiB |     58 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9516 MiB |   9516 MiB |  12336 MiB |   2820 MiB |
|       from large pool |   9500 MiB |   9500 MiB |  12320 MiB |   2820 MiB |
|       from small pool |     16 MiB |     16 MiB |     16 MiB |      0 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |     436    |     669    |    2677    |    2241    |
|       from large pool |      71    |     115    |    1390    |    1319    |
|       from small pool |     365    |     554    |    1287    |     922    |
|---------------------------------------------------------------------------|
| Active allocs         |     436    |     669    |    2677    |    2241    |
|       from large pool |      71    |     115    |    1390    |    1319    |
|       from small pool |     365    |     554    |    1287    |     922    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

UNet6 with 1 50 0.0001 32 180 done at Mon Nov 11 20:29:09 CET 2024
SBATCH job finished
